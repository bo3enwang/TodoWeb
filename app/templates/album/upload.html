{% extends 'base.html' %}
{% block csscontent %}
    <link href="{{ url_for('.static', filename = 'css/fileinput.min.css') }}" rel="stylesheet">
{% endblock %}
{% block sidebar %}
    <li id="nav_todo" class="treeview">
        <a href="/admin/todo/p">
            <span>待办事项</span>
        </a>
    </li>
    <li id="nav_p" class="treeview">
        <a href="/admin/project/p/progress">
            <span>我的计划</span></i>
        </a>
        <ul class="treeview-menu">
            <li id="nav_p_progress">
                <a href="/admin/project/p/progress">进行中</a>
            </li>
            <li id="nav_p_start"><a href="/admin/project/p/start"> 未激活</a></li>
            <li id="nav_p_end"><a href="/admin/project/p/end"> 已完成</a></li>
        </ul>
    </li>
    <li id="nav_todo" class="treeview">
        <a href="/admin/post/list">
            <span>博客文章</span>
        </a>
    </li>
    <li id="nav_todo" class="treeview active">
        <a href="/admin/album/list">
            <span>图片管理</span>
        </a>
    </li>
{% endblock %}
{% block content %}
    <section class="content-header">
        <h1>
            图片管理
            <small>Control panel</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
            <li class="active">上传图片</li>
        </ol>
    </section>

    <!-- Main content -->
    <section class="content">
        <div class="row">
            <div class="col-xs-12">
                <div class="box box-info">
                    <form id="fileForm" role="form" action="/admin/album/add" method="post"
                          enctype="multipart/form-data">
                        <div class="box-body">
                            <div class="form-group">
                                <label for="title">图片名</label>
                                <input type="text" class="form-control" id="img_name" name="img_name"
                                       placeholder="请输入图片名">
                            </div>
                            <div class="form-group">
                                <label for="tags">图片</label>
                                <input type="file" class="form-control" multiple="" id="file" name="file">
                            </div>
                        </div>
                        <!-- /.box-body -->

                        <div class="box-footer">
                            <button type="submit" class="btn btn-primary">提交</button>
                        </div>
                    </form>
                </div>
                <!-- /.box -->
            </div>
        </div>
    </section>



{% endblock %}
{% block jscontent %}
    <script src="{{ url_for('.static', filename = 'js/canvas-to-blob.min.js') }}"></script>
    <script src="{{ url_for('.static', filename = 'js/fileinput.min.js') }}"></script>
    <script src="{{ url_for('.static', filename = 'js/language/fileinput_locale_zh.js') }}"></script>
    <script>
        $(document).on('ready', function () {
            $("#file").fileinput({
                maxFileCount: 15,
                allowedFileExtensions: ["jpg", "gif", "png"],
                showRemove: false,
                showUpload: false
            });
            addValidate();
        });

        function addValidate() {
            $(document).ready(function () {
                $('#fileForm').bootstrapValidator({
                    message: 'This value is not valid',
                    feedbackIcons: {
                        valid: 'glyphicon glyphicon-ok',
                        invalid: 'glyphicon glyphicon-remove',
                        validating: 'glyphicon glyphicon-refresh'
                    },
                    fields: {
                        img_name: {
                            message: '验证不通过',
                            validators: {
                                notEmpty: {
                                    message: '文件名不能为空'
                                },
                                stringLength: {
                                    min: 1,
                                    max: 80,
                                    message: '请输入1~80个字符'
                                }
                            }
                        },
                        file: {
                            validators: {
                                notEmpty: {
                                    message: '请选择要上传的图片'
                                },
                                file: {
                                    extension: 'jpeg,jpg,png,gif',
                                    type: 'image/jpeg,image/png,image/gif',
                                    message: '请上传图片文件'
                                }
                            }
                        }
                    }
                });
            });
        }
    </script>
{% endblock %}